<div class="container">
  <div class="flat__show index_margin_top">
    <div class="flat__show_user">
      <h1><%= @flat.title %></h1>
    </div>
    <div class="flat__show__top__rating">
      <p><span><i class="fa-solid fa-star"></i> <%= @flat.average_rating.round(2) %></span> ● <span id="flat_show_undeline"><%= @flat.reviews.count %> Commentaires</span> ● <span id="flat_show_undeline"><%= @flat.address_by_coordinates %></span></p>
    </div>
    <div class="flat__show__images">
        <% if @flat.photo.key? %>
          <%= cl_image_tag @flat.photo.key, height: 300, width: 400 %>
        <% end %>
    </div>
    <div class="flat__show__infos">
      <div class="top_flat_infos_flex">
      <div class="flat_flex_top">
        <div class="flat__owner__infos">
          <h3><%= @flat.title %> · Chez <%= @flat.user.first_name %></h3>
        <div class="flat_description">
          <p><%= @flat.description %></p>
        </div>
        </div>
      </div>
      <div class="flat_infos_bottom">
      </div>
        <div class="flat__booking">
          <div class="flat__booking__price">
            <h4>Ajouter des dates pour voir le prix</h4>
            <p><span><i class="fa-solid fa-star"></i> <%= @flat.average_rating.round(2) %></span> ● <span id="flat_show_undeline"><%= @flat.reviews.count %> Commentaires</span></p>
          </div>
          <div class="flat__booking__dates">
            <%# <%= render 'form', @flat.flat__booking %>
            <div class="row">
              <%= simple_form_for [@flat, @booking] do |f| %>
                <div class="col">
                  <%= f.input :start_date, as: :string,
                              wrapper_html: { class: "mb-4" },
                              label_html: { class: "form-label text-secondary fw-bold" },
                              input_html: { data: { controller: "flatpickr" } } %>
                </div>
                <div class="col">
                  <%= f.input :end_date, as: :string,
                              wrapper_html: { class: "mb-4" },
                              label_html: { class: "form-label text-secondary fw-bold" },
                              input_html: { data: { controller: "flatpickr" } } %>
                </div>
              <% end %>
              <p><%= link_to "Vérifier la disponibilité", "#", class: "btn btn-primary py-2 px-7" %></p>
            </div>
          </div>
        </div>
      </div>
      <div class="flat__infos__flex">
        <div class="flat__reviews">
          <div class="reviews">
            <% @flat.reviews.includes(:user).each do |review| %>
              <div class="review">
              <h1><%= review.user.first_name %></h1>
                <p><%= review.content %></p>
                <p><%= review.rating %></p>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="flat__show__map">
    </div>
    <p><%= link_to "Mettre à jour", edit_flat_path(@flat), class: "btn btn-primary" %></p>
  </div>
</div>
